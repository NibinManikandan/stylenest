{% extends 'platform/common.html' %}
{% load static %}

{% block content %}

<style>
    body {
      text-align: left;
      background-color: #e2e8f0;
    }
    .main-body {
      padding: 15px;
    }

    .custom-navbar {
        background: #3b5d50 !important;
        padding-top: 20px;
        padding-bottom: 20px;
    }
    
    .nav-link {
      color: #4a5568;
    }
    .card {
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    }
    
    .card {
      position: relative;
      display: flex;
      flex-direction: column;
      min-width: 0;
      word-wrap: break-word;
      background-color: #fff;
      background-clip: border-box;
      border: 0 solid rgba(0, 0, 0, 0.125);
      border-radius: 0.25rem;
    }
    
    .card-body {
      flex: 1 1 auto;
      min-height: 1px;
      padding: 1rem;
    }
    
    .gutters-sm {
      margin-right: -8px;
      margin-left: -8px;
    }
    
    .gutters-sm > .col,
    .gutters-sm > [class*='col-'] {
      padding-right: 8px;
      padding-left: 8px;
    }
    .mb-3,
    .my-3 {
      margin-bottom: 1rem !important;
    }
    
    .bg-gray-300 {
      background-color: #e2e8f0;
    }
    .h-100 {
      height: 90% !important;
    }
    .shadow-none {
      box-shadow: none !important;
    }
  </style>

  <div class="container" style="margin-top: 50px;margin-bottom: 30px;">
    <div class="row gutters-sm">
      <div class="col-md-4 d-none d-md-block">
        <div class="card">
          <div class="card-body">
            <nav class="nav flex-column nav-pills nav-gap-y-1">

              <a href="#profile" data-toggle="tab" class="nav-item nav-link has-icon nav-link-faded active">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user mr-2">
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                  <circle cx="12" cy="7" r="4"></circle>
                </svg> Profile Information
              </a>

              <a href="#manage_address" data-toggle="tab" class="nav-item nav-link has-icon nav-link-faded">
                <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 56 56"><path fill="currentColor" d="M6.529 50.323c-1.091 0-1.952-.35-2.583-1.052c-.582-.648-.896-1.498-.94-2.55L3 46.454V8.87c0-1.19.315-2.133.946-2.827c.582-.641 1.36-.987 2.335-1.036L6.53 5h26.807c1.077 0 1.93.347 2.562 1.042c.582.64.895 1.493.94 2.557l.005.27v6.59h12.65c.993 0 1.798.3 2.411.897l.15.156c.582.647.896 1.497.94 2.549l.006.267v27.126c0 1.176-.315 2.115-.946 2.817c-.582.647-1.355.996-2.317 1.046l-.245.006zm30.314-3.869c0 .153-.005.302-.016.447h11.538c.411 0 .716-.1.915-.298c.17-.17.267-.424.291-.76l.007-.175V20.115c0-.425-.1-.737-.298-.936c-.17-.17-.419-.267-.745-.291l-.17-.006l-11.522-.001zM32.21 8.423H7.656c-.426 0-.737.099-.936.297c-.17.17-.267.424-.291.76l-.006.176v36.012c0 .425.099.736.297.935c.17.17.424.267.76.291l.176.007l4.867-.001v-6.27c0-.838.174-1.474.52-1.907l.108-.124c.38-.393.945-.607 1.694-.643l.23-.005h9.694c.878 0 1.523.216 1.934.648c.374.393.578.988.612 1.785l.005.245l-.001 6.271h4.89c.411 0 .716-.099.914-.297c.17-.17.268-.424.292-.76l.006-.175V9.656c0-.426-.1-.737-.298-.936c-.198-.198-.503-.297-.914-.297m-8.354 32.313h-7.866c-.412 0-.637.187-.675.562l-.005.118l-.001 5.484h9.226v-5.484c0-.412-.187-.637-.561-.675zm21.067-2.105c.441 0 .68.202.717.607l.005.116v3.316c0 .442-.202.681-.607.718l-.115.005h-3.423c-.429 0-.66-.203-.697-.607l-.004-.116v-3.316c0-.442.196-.681.59-.718l.111-.005zm0-8.12c.441 0 .68.202.717.607l.005.115v3.316c0 .442-.202.681-.607.718l-.115.005h-3.423c-.429 0-.66-.202-.697-.607l-.004-.116v-3.316c0-.442.196-.681.59-.718l.111-.005zm-27.913-1.723c.537 0 .826.248.867.743l.005.129v4.018c0 .536-.248.825-.743.866l-.129.005h-4.145c-.51 0-.785-.247-.824-.742l-.005-.13V29.66c0-.536.235-.825.706-.867l.123-.005zm9.95 0c.536 0 .824.248.866.743l.005.129v4.018c0 .536-.248.825-.743.866l-.129.005h-4.124c-.523 0-.805-.247-.845-.742l-.005-.13V29.66c0-.536.241-.825.724-.867l.126-.005zm17.963-6.399c.441 0 .68.203.717.608l.005.115v3.317c0 .441-.202.68-.607.717l-.115.005h-3.423c-.429 0-.66-.202-.697-.607l-.004-.115v-3.317c0-.441.196-.68.59-.718l.111-.005zm-27.913-2.02c.537 0 .826.248.867.744l.005.128v4.018c0 .537-.248.826-.743.867l-.129.005h-4.145c-.51 0-.785-.248-.824-.743l-.005-.129v-4.018c0-.536.235-.825.706-.866l.123-.005zm9.95 0c.536 0 .824.248.866.744l.005.128v4.018c0 .537-.248.826-.743.867l-.129.005h-4.124c-.523 0-.805-.248-.845-.743l-.005-.129v-4.018c0-.536.241-.825.724-.866l.126-.005zm-9.95-8.417c.537 0 .826.247.867.742l.005.13v4.017c0 .536-.248.825-.743.866l-.129.006h-4.145c-.51 0-.785-.248-.824-.743l-.005-.129v-4.018c0-.536.235-.825.706-.866l.123-.005zm9.95 0c.536 0 .824.247.866.742l.005.13v4.017c0 .536-.248.825-.743.866l-.129.006h-4.124c-.523 0-.805-.248-.845-.743l-.005-.129v-4.018c0-.536.241-.825.724-.866l.126-.005z"/>
                </svg> Manage address
              </a>

              <a href="#orders" class="nav-item nav-link has-icon nav-link-faded">
                <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9.207 16.455C9.207 17.86 8.095 19 6.724 19s-2.483-1.14-2.483-2.546m4.966 0c0-1.405-1.112-2.545-2.483-2.545s-2.483 1.14-2.483 2.545m4.966 0h5.586m-10.552 0H3V6a1 1 0 0 1 1-1h9.793a1 1 0 0 1 1 1v2.182m5.586 8.272c0 1.406-1.111 2.546-2.482 2.546c-1.372 0-2.483-1.14-2.483-2.546m4.965 0c0-1.405-1.111-2.545-2.482-2.545c-1.372 0-2.483 1.14-2.483 2.545m4.965 0H21v-5.09l-2.515-2.579a2 2 0 0 0-1.431-.603h-2.26m.62 8.272h-.62m0 0V8.182"/>
                </svg> My Orders
              </a>
              
              <a href="#security" data-toggle="tab" class="nav-item nav-link has-icon nav-link-faded">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-shield mr-2">
                  <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg> Security
              </a>

              <a href="{% url 'logout' %}" class="nav-item nav-link has-icon nav-link-faded">
                <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="32" stroke-dashoffset="32" d="M12 4H5C4.44772 4 4 4.44772 4 5V19C4 19.5523 4.44772 20 5 20H12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.4s" values="32;0"/></path><path stroke-dasharray="12" stroke-dashoffset="12" d="M9 12h11.5" opacity="0"><set attributeName="opacity" begin="0.5s" to="1"/><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.5s" dur="0.2s" values="12;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M20.5 12l-3.5 -3.5M20.5 12l-3.5 3.5" opacity="0"><set attributeName="opacity" begin="0.7s" to="1"/><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.7s" dur="0.2s" values="6;0"/></path></g>
                </svg> Logout
              </a>

            </nav>
          </div>
        </div>
      </div>
      
      <div class="col-md-8">
        <div class="card">
          <div class="card-header border-bottom mb-3 d-flex d-md-none">
            <ul class="nav nav-tabs card-header-tabs nav-gap-x-1" role="tablist">

              <li class="nav-item">
                <a href="#profile" data-toggle="tab" class="nav-link has-icon active">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg>
                </a>
              </li>

              <li class="nav-item">
                <a href="#manage_address" data-toggle="tab" class="nav-link has-icon active">
                  <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 56 56"><path fill="currentColor" d="M6.529 50.323c-1.091 0-1.952-.35-2.583-1.052c-.582-.648-.896-1.498-.94-2.55L3 46.454V8.87c0-1.19.315-2.133.946-2.827c.582-.641 1.36-.987 2.335-1.036L6.53 5h26.807c1.077 0 1.93.347 2.562 1.042c.582.64.895 1.493.94 2.557l.005.27v6.59h12.65c.993 0 1.798.3 2.411.897l.15.156c.582.647.896 1.497.94 2.549l.006.267v27.126c0 1.176-.315 2.115-.946 2.817c-.582.647-1.355.996-2.317 1.046l-.245.006zm30.314-3.869c0 .153-.005.302-.016.447h11.538c.411 0 .716-.1.915-.298c.17-.17.267-.424.291-.76l.007-.175V20.115c0-.425-.1-.737-.298-.936c-.17-.17-.419-.267-.745-.291l-.17-.006l-11.522-.001zM32.21 8.423H7.656c-.426 0-.737.099-.936.297c-.17.17-.267.424-.291.76l-.006.176v36.012c0 .425.099.736.297.935c.17.17.424.267.76.291l.176.007l4.867-.001v-6.27c0-.838.174-1.474.52-1.907l.108-.124c.38-.393.945-.607 1.694-.643l.23-.005h9.694c.878 0 1.523.216 1.934.648c.374.393.578.988.612 1.785l.005.245l-.001 6.271h4.89c.411 0 .716-.099.914-.297c.17-.17.268-.424.292-.76l.006-.175V9.656c0-.426-.1-.737-.298-.936c-.198-.198-.503-.297-.914-.297m-8.354 32.313h-7.866c-.412 0-.637.187-.675.562l-.005.118l-.001 5.484h9.226v-5.484c0-.412-.187-.637-.561-.675zm21.067-2.105c.441 0 .68.202.717.607l.005.116v3.316c0 .442-.202.681-.607.718l-.115.005h-3.423c-.429 0-.66-.203-.697-.607l-.004-.116v-3.316c0-.442.196-.681.59-.718l.111-.005zm0-8.12c.441 0 .68.202.717.607l.005.115v3.316c0 .442-.202.681-.607.718l-.115.005h-3.423c-.429 0-.66-.202-.697-.607l-.004-.116v-3.316c0-.442.196-.681.59-.718l.111-.005zm-27.913-1.723c.537 0 .826.248.867.743l.005.129v4.018c0 .536-.248.825-.743.866l-.129.005h-4.145c-.51 0-.785-.247-.824-.742l-.005-.13V29.66c0-.536.235-.825.706-.867l.123-.005zm9.95 0c.536 0 .824.248.866.743l.005.129v4.018c0 .536-.248.825-.743.866l-.129.005h-4.124c-.523 0-.805-.247-.845-.742l-.005-.13V29.66c0-.536.241-.825.724-.867l.126-.005zm17.963-6.399c.441 0 .68.203.717.608l.005.115v3.317c0 .441-.202.68-.607.717l-.115.005h-3.423c-.429 0-.66-.202-.697-.607l-.004-.115v-3.317c0-.441.196-.68.59-.718l.111-.005zm-27.913-2.02c.537 0 .826.248.867.744l.005.128v4.018c0 .537-.248.826-.743.867l-.129.005h-4.145c-.51 0-.785-.248-.824-.743l-.005-.129v-4.018c0-.536.235-.825.706-.866l.123-.005zm9.95 0c.536 0 .824.248.866.744l.005.128v4.018c0 .537-.248.826-.743.867l-.129.005h-4.124c-.523 0-.805-.248-.845-.743l-.005-.129v-4.018c0-.536.241-.825.724-.866l.126-.005zm-9.95-8.417c.537 0 .826.247.867.742l.005.13v4.017c0 .536-.248.825-.743.866l-.129.006h-4.145c-.51 0-.785-.248-.824-.743l-.005-.129v-4.018c0-.536.235-.825.706-.866l.123-.005zm9.95 0c.536 0 .824.247.866.742l.005.13v4.017c0 .536-.248.825-.743.866l-.129.006h-4.124c-.523 0-.805-.248-.845-.743l-.005-.129v-4.018c0-.536.241-.825.724-.866l.126-.005z"/>
                  </svg>
                </a>
              </li>
              
              <li class="nav-item">
                <a href="#security" data-toggle="tab" class="nav-link has-icon">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-shield">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                  </svg>
                </a>
              </li> 
            </ul>
          </div>

          {% comment %} profile info {% endcomment %}
          
          <div class="card-body tab-content">
            <div class="tab-pane active" id="profile">
              <h6>YOUR PROFILE INFORMATION</h6>
              <hr />
              <form method="POST" action = "{% url 'edit_details' %}">
                {% csrf_token %}
                <div class="form-group">
                  <label for="firstName">First Name</label>
                  <input type="text"  class="form-control" id="firstame" name = "firstname" aria-describedby="firstnameHelp" placeholder="Enter your first name" value="{{data.first_name}}" />
                </div>

                <div class="form-group">
                  <label for="lastName">Last Name</label>
                  <input type="text" class="form-control" id="lastame" name = 'lastname' aria-describedby="lastameHelp" placeholder="Enter your last name" value="{{data.last_name}}" />
                </div>

                <div class="form-group">
                  <label for="url">Phone</label>
                  <input type="numeric" class="form-control" id="phone" name = 'phone' placeholder="Enter your Phone Number" value="{{data.phone}}" />
                </div>

                <div class="form-group">
                  <label for="location">Email</label>
                  <input class="form-control" type="email" placeholder="Email" aria-label="Disabled input example" value="{{data.email}}" disabled />
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 20px;">Update Changes</button>
              </form>
            </div>

            {% comment %} manage address {% endcomment %}

            <div class="tab-pane" id="manage_address">
              <h6>MANAGE ADDRESS</h6>
              <hr />
              <form method="POST" action="{% url 'manage_address' %}">
                {% csrf_token %}
                <div class="form-group row">
                <div class="col-md-6">
                  <label for="c_diff_fname" class="text-black">First Name <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="c_diff_fname" name="fname">
                </div>

                <div class="col-md-6">
                  <label for="c_diff_lname" class="text-black">Last Name <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="c_diff_lname" name="lname">
                </div>
                </div>
      
                <div class="form-group row">
                  <div class="col-md-12">
                  <label for="c_address" class="text-black">Address <span class="text-danger">*</span></label>
                  <textarea class="form-control" type="text" name="c_address" id="exampleFormControlTextarea1" rows="2" placeholder="Street address"></textarea>
                  </div>
                </div>
          
                <div class="form-group row">
                  <div class="col-md-12">
                  <label for="c_companyname" class="text-black">City <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="c_city" name="city" placeholder="City">
                  </div>
                </div>
                
                <div class="form-group row">
                  <div class="col-md-12">
                  <label for="c_companyname" class="text-black">Landmark <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="c_landmark" name="landmark" placeholder="Landmark">
                  </div>
                </div>

                <div class="form-group row">
                  <div class="col-md-6">
                    <label for="c_diff_fname" class="text-black">Country <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="c_diff_fname" name="country">
                  </div>
      
                <div class="form-group row">
                <div class="col-md-6">
                  <label for="c_diff_state_country" class="text-black">State <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="c_diff_state" name="state">
                </div>
                
                <div class="col-md-6">
                  <label for="c_diff_postal_zip" class="text-black">Posta / Zip <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="c_diff_postal_zip" name="postal_zip">
                </div>
                </div>
      
                <div class="col-md-6">
                  <label for="c_diff_phone" class="text-black">Phone <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="c_diff_phone" name="c_phone" placeholder="Alter native Phone Number">
                </div>
                </div>
                <hr />
                <button type="submit" class="btn btn-primary">Save</button>
              </div>
            </form>
            
            {% comment %} security settings {% endcomment %}

            <div class="tab-pane" id="security">
              <h6>SECURITY SETTINGS</h6>
              <hr />
              <form method="POST" action="{% url 'change_password' %}">
                {% csrf_token %}
                  <div class="form-group">
                    <label class="d-block">Change Password</label>
                    <input type="password" name='old_pass' class="form-control" placeholder="Enter your old password" />
                    <input type="password" name='new_pass' class="form-control mt-1" placeholder="New password" />
                    <input type="password" name='cnf_new_pass' class="form-control mt-1" placeholder="Confirm new password" />
                  </div>
                <hr />
                <button type="submit" class="btn btn-primary">Reset</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript"></script>
    
  <script>
    function changePassword() {
    var old_pass = document.getElementById('old_pass').value;
    var new_pass = document.getElementById('new_pass').value;
    var cnf_new_pass = document.getElementById('cnf_new_pass').value;

    var passwordPattern = /^([a-zA-Z0-9]).{6,}$/;

    var data = {
      'old_pass': old_pass,
      'new_pass': new_pass,
      'cnf_new_pass': cnf_new_pass
    };

    $.ajax({
      type: 'POST',
      url: '/change_password/',
      contentType: 'application/json',
      data: JSON.stringify(data),

      success: function(response) {
        if (!passwordPattern.test(newPass)) {
          alert('New password must be at least 6 characters long and can contain letters and numbers only.');
          return false;
      }
        if (response.valid) {
          Swal.fire({
            icon: "success",
            title: response.message,
          });
        }
        if (newPass !== cnfNewPass) {
          alert('New passwords do not match.');
          return false;
        } else {
          Swal.fire({
            icon: "error",
            title: response.message,
          });
        }
      },
      error: function(xhr, textStatus, errorThrown) {
        alert('Failed to change password: ' + xhr.statusText);
      }
    });
  }
  </script>


{% endblock %}
